extends ../index

block main
  .pure-u-1
    .l-box
      +breadcrumbs_from(bcList)

      //- h1 #{documents.RM[0].document[0].document_id}

      if (error)
        h1= "Error ["+error.code[0]+"]: "+error.description[0]
      else
        h1.capitalize= String(company.name).toLowerCase()

      .pure-g-r
        if company
          .pure-u-1
            #responsiveTabs
              ul
                li
                  h3: a(href="#details") Details
                if reports
                  li
                    h3: a(href="#reports") Reports
                if documents
                  li
                    h3: a(href="#documents") Documents

              #details
                .pure-g-r
                  .pure-u-5-24
                    .company-data
                      p Registered Number
                      span#cro_number| #{company.id}

                    .company-data
                      p Registered Office
                      address
                        | #{company.address1}
                        | <br/> #{company.address2}
                        | <br/> #{company.address3}

                        if String(company.address4).trim() != String(company.postcode).trim()
                          | <br/> #{company.address4}

                        | <br/> #{company.postcode}

                  .pure-u-1-24.pure-hidden-phone
                    .l-box
                      br
                  .pure-u-5-24
                    .company-data
                      p Company Type
                      | #{company.type}

                    .company-data
                      p Incorporated
                      | #{company.incorporation_date}

                    .company-data
                      p Status
                      | #{company.status}
                  .pure-u-1-24.pure-hidden-phone
                    .l-box
                      br
                  .pure-u-5-24
                    .company-data
                      p Latest Accounts
                      | #{company.latestAccounts}
                    .company-data
                      p Latest Annual Return
                      | #{company.latestAnnualReturn}
                    .company-data
                      p Accounts Type
                      | #{company.accountsType}
                  .pure-u-1-24.pure-hidden-phone
                    .l-box
                      br
                  .pure-u-5-24
                    .company-data
                      p Last document filed
                      p Previous names
              #reports
                .pure-g-r
                  if reports
                    each vendor in Object.keys(reports)
                      .pure-u-1-3
                        .l-box
                          .report-box.hover-shadow
                            a(href="/companies/"+country+"/"+company.id+"/"+slug(company.name).toLowerCase()+"/reports/"+slug(vendor).toLowerCase())
                              if images[vendor.toLowerCase()]
                                img(src="/images/partner-logos/bw/#{slug(images[vendor.toLowerCase()]).toLowerCase()}.png", alt="#{images[vendor.toLowerCase()]}")
                              else
                                p #{vendor}
                              each rep, index in reports[vendor][0].report
                                if index < 3
                                  div(class="report-#{index+1}") #{rep.description}
              #documents
                .pure-g-r
                  if documents
                    each vendor in Object.keys(documents)
                      .pure-u-1-3
                        .l-box
                          .report-box.hover-shadow
                            a(href="/companies/"+country+"/"+company.id+"/documents/"+slug(vendor).toLowerCase())
                              img(src="/images/partner-logos/bw/#{slug(vendor).toLowerCase()}.png", alt="#{vendor}")
                              each doc, index in documents[vendor][0].document
                                if index < 3
                                  div(class="document-#{index+1}") [#{doc.document_type}] #{doc.doc_description}, #{doc.document_id}

                              //- Need something more sophistciated to group the available docs into 3, by cabinet
                              //- - var label = ""
                              //- - var comma = ""
                              //- - var divIndex = 1
                              //- - var cabCount = 1
                              //- each cabinet, index in documentsByCabinet[0][vendor.toUpperCase()]
                              //-   //- if cabinet.values.length > 0
                              //-   if cabCount == 4
                              //-     div(class="document-#{divIndex}") #{label}
                              //-     - label = ""
                              //-     - comma = ""
                              //-     - divIndex++
                              //-     - cabCount = 1
                              //-   else
                              //-     - label += comma+cabinet.label
                              //-     - comma = ", "
                              //-     - cabCount++
